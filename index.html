<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">

    <meta name="description"
        content="Игровой проект РЖД путь к морю в Roblox. Управляй поездами и осваивай железнодорожные пути!">
    <meta name="keywords"
        content="РЖД, RZD, Roblox, путь к морю, ржд путь к морю, жд в roblox, roblox игра симулятор поезда">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="robots" content="index, follow">
    <meta name="author" content="Aman, DrOmA">

    <!--Превью при отправке-->

    <!--Open Graph для Fecebook, Telegram, WhatsApp, Discord-->
    <meta property="og.title" content="РЖД-Путь к морю.">
    <meta property="og.description" content="краткое описание">
    <meta property="og.image" content="https://RZDPytKMory.ru/Preview.png">
    <meta property="og.url" content="https://RZDPytKMory.ru">
    <meta property="og.type" content="website">
    <meta property="og.locale" content="ru_RU>

    <!--Для Twitter-->
    <meta name=" twitter.cart" content="summary_large_image">
    <meta name="twitter:title" content="название страницы">
    <meta name="twitter:description" content="краткое описание">
    <meta name="twitter:image" content="https://сайт.ru/путь к картинке.jpg">

    <!--Защита-->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Option" content="DENY">
    <meta http-equiv="X-XSS-Protecttion" content="1; mode=block">
    <meta name="referrer" content="no-referrer-when-downgrade">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <!-- Подключение Firebase -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/js-sha256/0.9.0/sha256.min.js"></script>

    <title>Document</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css"
        integrity="sha512-DxV+EoADOkOygM4IR9yXP8Sb2qwgidEmeqAEmDKIOfPRQZOWbXCzLC6vjbZyy0vPisbH2SyW27+ddLVCN+OMzQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer" /link>


        <style>
        /* Ваши существующие стили остаются без изменений */
        /* Добавляем стиль для экрана блокировки */
        .lock-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 1000;
            color: white;
            font-size: 24px;
            text-align: center;
        }
        
        .lock-screen h2 {
            color: #ff4444;
            margin-bottom: 20px;
        }
        
        .lock-screen p {
            margin-bottom: 10px;
        }
        
        .lock-screen .unlock-time {
            color: #44ff44;
            font-weight: bold;
        }

    </style>  
</head>

<body>

      <!-- Экран блокировки (изначально скрыт) -->
    <div id="lockScreen" class="lock-screen" style="display: none;">
        <h2><i class="fas fa-lock"></i> ДОСТУП ЗАБЛОКИРОВАН</h2>
        <p id="lockReason">Причина блокировки не указана</p>
        <p>До разблокировки осталось: <span id="unlockTimer" class="unlock-time">--:--</span></p>
    </div>

    <!-- Ваш существующий HTML код остается без изменений -->
    <div id="loginPage">
        <!-- ... -->
    </div>

    <div id="adminPage">
        <!-- ... -->
    </div>

      <script>
        // Конфигурация системы (добавляем параметры блокировки)
        const SECURITY_CONFIG = {
            correctLogin: "RZD-02",
            correctPassword: "2202020",
            maxAttempts: 3,
            tempBlockTime: 60 * 60 * 1000, // 1 час
            permBlockAfter: 5, // После 5 блокировок - перманентная
            blockedUsers: ["RZD-01", "RZD-03"], // Список заблокированных пользователей
            blockedIPs: ["192.168.1.100", "10.0.0.15"] // Список заблокированных IP
        };

        // При загрузке страницы сразу проверяем блокировку
        document.addEventListener('DOMContentLoaded', async function() {
            initParticles();
            
            // Проверяем блокировку по IP
            const clientIP = await getClientIP();
            if (SECURITY_CONFIG.blockedIPs.includes(clientIP)) {
                showLockScreen("Ваш IP адрес заблокирован", null, true);
                return;
            }
            
            // Проверяем блокировку по пользователю (если уже авторизован)
            if (sessionStorage.getItem('authToken')) {
                const login = sessionStorage.getItem('userLogin');
                if (SECURITY_CONFIG.blockedUsers.includes(login)) {
                    showLockScreen("Ваш аккаунт заблокирован", null, true);
                    return;
                }
                showAdminPage();
            } else {
                // Проверяем временную блокировку
                await checkBlockStatus();
            }
            
            // Остальной код инициализации...
        });

        // Функция показа экрана блокировки
        function showLockScreen(reason, expires = null, isPermanent = false) {
            const lockScreen = document.getElementById('lockScreen');
            const lockReason = document.getElementById('lockReason');
            const unlockTimer = document.getElementById('unlockTimer');
            
            // Показываем причину
            lockReason.textContent = reason;
            
            // Для временной блокировки показываем таймер
            if (expires && !isPermanent) {
                const updateTimer = () => {
                    const now = Date.now();
                    if (now >= expires) {
                        location.reload();
                        return;
                    }
                    
                    const diff = expires - now;
                    const minutes = Math.floor(diff / 60000);
                    const seconds = Math.floor((diff % 60000) / 1000);
                    
                    unlockTimer.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
                };
                
                updateTimer();
                setInterval(updateTimer, 1000);
            } else if (isPermanent) {
                unlockTimer.textContent = "НИКОГДА";
            } else {
                unlockTimer.textContent = "НЕИЗВЕСТНО";
            }
            
            // Показываем экран блокировки и скрываем другие элементы
            lockScreen.style.display = "flex";
            document.getElementById('loginPage').style.display = "none";
            document.getElementById('adminPage').style.display = "none";
        }

        // Модифицированная функция проверки блокировки
        async function checkBlockStatus() {
            const securityData = await getSecurityData();
            const userFingerprint = await getFingerprint();

            // Проверка перманентной блокировки
            if (securityData.permBlocks.includes(userFingerprint)) {
                showLockScreen("Ваш аккаунт заблокирован навсегда", null, true);
                return true;
            }

            // Проверка временной блокировки
            const userBlocks = securityData.blocks.filter(b =>
                b.fingerprint === userFingerprint &&
                b.expires > Date.now()
            );

            if (userBlocks.length > 0) {
                const block = userBlocks[0];
                showLockScreen("Слишком много неудачных попыток входа", block.expires);
                return true;
            }

            return false;
        }

        // Функция блокировки пользователя (для админки)
        async function blockUser(login, permanent = false) {
            if (!SECURITY_CONFIG.blockedUsers.includes(login)) {
                SECURITY_CONFIG.blockedUsers.push(login);
                
                // Если пользователь онлайн, немедленно блокируем
                if (sessionStorage.getItem('userLogin') === login) {
                    showLockScreen("Ваш аккаунт был заблокирован администратором", null, permanent);
                }
                
                return true;
            }
            return false;
        }

        // Функция блокировки IP (для админки)
        async function blockIP(ip, permanent = false) {
            if (!SECURITY_CONFIG.blockedIPs.includes(ip)) {
                SECURITY_CONFIG.blockedIPs.push(ip);
                
                // Если IP совпадает с текущим, немедленно блокируем
                const currentIP = await getClientIP();
                if (currentIP === ip) {
                    showLockScreen("Ваш IP адрес был заблокирован администратором", null, permanent);
                }
                
                return true;
            }
            return false;
        }

        // Остальные функции остаются без изменений
        // ...
    </script> 
    
    <div class="fullscreen-image">
        <div class="image-content">
            <h1>РЖД ПУТЬ К МОРЮ</h1>
            <p>Лучший ЖД симулятор</p>
            <a href="Playing now.html" class="btn">Играть сейчас!</a>
        </div>
    </div>

    <div class="second-block">
        <h2>Второй блоsыessкs</h2>
        <div class="fs">
            <div class="card">
                <i class="fa-solid fa-link fa-3x"></i>
                <h3>Играть сейчас</h3>
                <h4>Жми и веди поезд к морю!</h4>
            </div>
            <div class="card">
                <i class="fa-solid fa-bolt fa-3x"></i>
                <h3>Последние новости</h3>
                <h4>Будь в курсе актуаных новостей сервера.</h4>
            </div>

            <div class="card" onclick="openAdminPanel()">
                <i class="fa-solid fa-user-tie fa-3x"></i>
                <h3>Для администрации</h3>
                <h4>Не тыкай</h4>
            </div>
        </div>
        <div class="fs">
            <div class="card">
                <i class="fa-solid fa-train-subway fa-3x"></i>
                <h3>Подвижной состав серверавss</h3>
                <h4>Скоро...</h4>
            </div>
            <div class="card">
                <i class="fa-solid fa-id-badge fa-3x"></i>
                <h3>Роли</h3>
                <h4>Скоро...</h4>
            </div>
            <div class="card">
                <i class="fa-solid fa-code fa-3x"></i>
                <h3>Предложения для разработки</h3>
                <h4>Скоро...</h4>
            </div>
        </div>
    </div>
    <footer class="fot">
        <div class="cardfot">
            <i class="fa-brands fa-telegram"></i>
            <p>Telegram</p>
        </div>
    </footer>

 <!-- Модальное окно администратора -->
<div id="adminModal" class="admin-modal">
    <div class="admin-login-box">
        <div class="admin-login-header">
            <h2><i class="fas fa-lock"></i> Аутентификация</h2>
            <p>Доступ только для авторизованного персонала</p>
        </div>
        
        <div class="input-group">
            <label for="adminLogin"><i class="fas fa-user"></i> Логин:</label>
            <input type="text" id="adminLogin" class="admin-login-input" placeholder="Введите логин">
        </div>
        
        <div class="input-group">
            <label for="adminPassword"><i class="fas fa-key"></i> Пароль:</label>
            <input type="password" id="adminPassword" class="admin-login-input" placeholder="Введите пароль">
        </div>
        
        <button onclick="checkAdminCredentials()" class="admin-login-btn">
            <i class="fas fa-sign-in-alt"></i> Войти
        </button>
        
        <div class="security-info">
            <p><i class="fas fa-shield-alt"></i> Все попытки входа регистрируются</p>
        </div>
    </div>
</div>
   

     <script src="https://cdnjs.cloudflare.com/ajax/libs/js-sha256/0.9.0/sha256.min.js"></script>

    <script src="script.js"></script>
</body>


<footer>
    <!--Защита от копирования-->
    <script>
        document.addEventListener('copy', (e) => {
            e.preventDefault();
            alert('Копирование запрещено!');
        });

        <!--Защита от открытия в Iframe-->

        if (window !== top) {
            top.location.href = location.href;
        }
    </script>
</footer>

</html>